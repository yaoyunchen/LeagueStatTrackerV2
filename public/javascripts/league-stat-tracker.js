var LeagueStatTrackerApp=angular.module("LeagueStatTrackerApp",["ngRoute","ngAnimate","ngDialog","angularCharts"]);LeagueStatTrackerApp.config(["$routeProvider",function(e){e.when("/",{templateUrl:"home.ejs",controller:"mainController"}).when("/summoner",{templateUrl:"summoner.ejs",controller:"summonerController"})}]);var LeagueStatTrackerApp=angular.module("LeagueStatTrackerApp");LeagueStatTrackerApp.directive("homepage",["$location",function(e){return{restrict:"E",transclude:!0,templateUrl:"home.ejs",link:function(a,t,r){a.go=function(a){e.path(a)}}}}]);var LeagueStatTrackerApp=angular.module("LeagueStatTrackerApp");LeagueStatTrackerApp.directive("navbar",function(){return{restrict:"E",transclude:!0,scope:{},templateUrl:"navbar.ejs"}});var LeagueStatTrackerApp=angular.module("LeagueStatTrackerApp");LeagueStatTrackerApp.directive("ngbgslideshow",["$interval",function(e){return{restrict:"E",transclude:!0,templateUrl:"slideshow.ejs",link:function(a,t,r){a.active_image=0,a.interval=5e3,a.$watch("freeChamps",function(){if(void 0!=a.freeChamps.images){var e=[],t=[];a.freeChamps.images.forEach(function(a){e.push("http://ddragon.leagueoflegends.com/cdn/img/champion/splash/"+a.value[0].key+"_0.jpg"),t.push(a.value[0].name)}),a.images=e,a.names=t,a.champName=t[a.active_image]}},!0);var n=e(function(){a.active_image++,a.champName=a.names[a.active_image],a.active_image>=a.images.length&&(a.active_image=0),a.champName=a.names[a.active_image]},a.interval||1e3);a.$on("$destroy",function(){e.cancel(n)})}}}]);var LeagueStatTrackerApp=angular.module("LeagueStatTrackerApp");LeagueStatTrackerApp.directive("summonerinfo",function(){return{restrict:"E",transclude:!0,templateUrl:"summoner-info.ejs"}}),LeagueStatTrackerApp.directive("summonerrecent",function(){return{restrict:"E",transclude:!0,templateUrl:"summoner-recent.ejs"}}),LeagueStatTrackerApp.directive("summonerrunes",function(){return{restrict:"E",transclude:!0,templateUrl:"summoner-runes.ejs"}}),LeagueStatTrackerApp.directive("summonermasteries",function(){return{restrict:"E",transclude:!0,templateUrl:"summoner-masteries.ejs"}});var LeagueStatTrackerApp=angular.module("LeagueStatTrackerApp");LeagueStatTrackerApp.directive("tab",function(){return{restrict:"E",transclude:!0,template:'<div role="tabpanel" class="tab" ng-show="active" ng-transclude></div>',require:"^tabset",scope:{heading:"@"},link:function(e,a,t,r){e.active=!1,r.addTab(e)}}}),LeagueStatTrackerApp.directive("tabset",function(){return{restrict:"E",transclude:!0,scope:{},templateUrl:"tabset.ejs",bindToController:!0,controllerAs:"tabset",controller:function(){var e=this;e.tabs=[],e.addTab=function(a){e.tabs.push(a),1===e.tabs.length&&(a.active=!0)},e.select=function(a){angular.forEach(e.tabs,function(e){e.active&&e!=a&&(e.active=!1)}),a.active=!0}}}});var LeagueStatTrackerApp=angular.module("LeagueStatTrackerApp");LeagueStatTrackerApp.controller("mainController",["$scope","$champions","$location",function(e,a,t){e.pageClass="page-home",e.freeChamps=a.getFree(function(){e.getChamps()}),e.go=function(){t.path("/summoner")},e.getChamps=function(){if(10==e.freeChamps.value.length){var t=[];e.freeChamps.value.forEach(function(r){var n=a.getChamp(r.id,function(){t.push(n),10==t.length&&(e.freeChamps.images=t)})})}}}]);var LeagueStatTrackerApp=angular.module("LeagueStatTrackerApp");LeagueStatTrackerApp.controller("summonerController",["$scope","ngDialog","$summoner","$regions","$gameTypes","$champions",function(e,a,t,r,n,s){e.pageClass="page-summoner",e.regions=r.getRegions(),e.searchName="",e.summoner,e.iconUrl="http://ddragon.leagueoflegends.com/cdn/6.5.1/img/profileicon/0.png",e.summonerSearch=function(a){a&&(e.summoner=t.get(e.searchName,e.regions.value.selectedOption.name,function(){e.getStats(),e.getRank(),e.getRecent(),e.iconUrl="http://ddragon.leagueoflegends.com/cdn/6.5.1/img/profileicon/"+e.summoner.value.profileIconId+".png"}))},e.getStats=function(a){e.summoner.stats=t.getStats(e.summoner.value.id,e.regions.value.selectedOption.name,function(){e.getData("wins","Total Wins")})},e.getRank=function(){e.summoner.rank=t.getRank(e.summoner.value.id,e.regions.value.selectedOption.name)},e.getRecent=function(a){e.summoner.recent=t.getRecent(e.summoner.value.id,e.regions.value.selectedOption.name,function(){e.getChamp()})},e.getChamp=function(){e.summoner.recent.forEach(function(a){var t={teamOne:[],teamTwo:[]};if(a.fellowPlayers.forEach(function(e){var a=s.getChamp(e.championId,function(){100==e.teamId?t.teamOne.push({id:e.summonerId,champ:a.value}):200==e.teamId&&t.teamTwo.push({id:e.summonerId,champ:a.value})})}),100==a.teamId)var r=s.getChamp(a.championId,function(){t.teamOne.push({id:e.summoner.value.id,champ:r.value}),a.champ=r.value});else var r=s.getChamp(a.championId,function(){t.teamTwo.push({id:e.summoner.value.id,champ:r.value}),a.champ=r.value});a.teams=t})},e.getData=function(a,t){return""==e.searchName?!1:void e.getGameTypes(a,t,function(){for(var r=e.summoner.stats,n=[],s=[],o=0;o<r.length;o++){for(var c,u,i=0;i<e.gameTypes.value.length;i++)if(r[o].playerStatSummaryType==e.gameTypes.value[i].type){c=i;break}n.push(e.gameTypes.value[c].name);var l=r[o].aggregatedStats;switch(a){case"wins":u=r[o].hasOwnProperty("wins")?r[o].wins:0;break;case"totalchampionkills":u=l.hasOwnProperty("totalChampionKills")?l.totalChampionKills:0;break;case"totalneutralminionskilled":u=l.hasOwnProperty("totalNeutralMinionsKilled")?l.totalNeutralMinionsKilled:0;break;case"totalminionkills":u=l.hasOwnProperty("totalMinionKills")?l.totalMinionKills:0;break;case"totalassists":u=l.hasOwnProperty("totalAssists")?l.totalAssists:0;break;case"totalturretskilled":u=l.hasOwnProperty("totalTurretsKilled")?l.totalTurretsKilled:0;break;default:u=0}var m={x:e.gameTypes.value[c].code,y:[u],tooltip:e.gameTypes.value[c].name};s.push(m)}e.config={title:t,tooltips:!0,labels:!0,isAnimate:!0},e.data={series:n,data:s}})},e.getGameTypes=function(a,t,r){e.gameTypes=n.getGameTypes(function(){r&&r()})}}]);var LeagueStatTrackerApp=angular.module("LeagueStatTrackerApp");LeagueStatTrackerApp.factory("$champions",["$http","$q",function(e,a){"use strict";return{getFree:function(t){var r=a.defer(),n=[],s="/search/freechamps",o="?callback=JSON_CALLBACK",c=s+o;return e.get(c).then(function(e){r.resolve(n=e.data.champions),t&&t()}),r.promise.$$state},getChamp:function(t,r){var n=a.defer(),s=[],o="/champs",c="?callback=JSON_CALLBACK",u=o+"/"+t+c;return e.get(u).then(function(e){n.resolve(s=e.data),r&&r()}),n.promise.$$state},getChampImages:function(t){var r=a.defer(),n=[],s="na",o="/search/champ",c="?callback=JSON_CALLBACK",u=o+"/"+s+"/"+t+c;return e.get(u).then(function(e){200==e.status&&r.resolve(n=e.data.key)}),r.promise.$$state}}}]),LeagueStatTrackerApp.factory("$regions",["$http","$q",function(e,a){return{getRegions:function(){var t=a.defer(),r=[],n="/regions",s="?callback=JSON_CALLBACK",o=n+s;return e.get(o).then(function(e){e.data;t.resolve(r={repeatSelect:null,availableOptions:e.data,selectedOption:{_id:"56ef9c3f6c332ceddc62c20a",id:7,name:"na"}})}),t.promise.$$state}}}]),LeagueStatTrackerApp.factory("$gameTypes",["$http","$q",function(e,a){return{getGameTypes:function(t){var r=a.defer(),n=[],s="/gametypes",o="?callback=JSON_CALLBACK",c=s+o;return e.get(c).then(function(e){r.resolve(n=e.data),t&&t()}),r.promise.$$state}}}]);var LeagueStatTrackerApp=angular.module("LeagueStatTrackerApp");LeagueStatTrackerApp.factory("$summoner",["$http","$q",function(e,a){"use strict";return{get:function(t,r,n){var s=a.defer(),o={},c="/search",u="?callback=JSON_CALLBACK",i=c+"/"+r+"/"+t+u;return e.get(i).then(function(e){if(200==e.status){var a=t;for(a in e.data){if(1==e.data.hasOwnProperty("status")&&e.data.status.hasOwnProperty("status_code")&&404==e.data.status.status_code)break;e.data.hasOwnProperty(a)&&s.resolve(o[a]=e.data[a]),n&&n()}}}),s.promise.$$state},getStats:function(a,t,r){var n=[],s="/search/stats",o="?callback=JSON_CALLBACK",c=s+"/"+t+"/"+a+o;return e.get(c).then(function(e){if(200==e.status){for(var a=e.data.playerStatSummaries,t=0;t<a.length;t++)n[t]=a[t];r&&r()}}),n},getRank:function(a,t){var r=[],n="/search/rank",s="?callback=JSON_CALLBACK",o=n+"/"+t+"/"+a+s;return e.get(o).then(function(e){if(200==e.status){var t=a;for(t in e.data){if(1==e.data.hasOwnProperty("status")&&e.data.status.hasOwnProperty("status_code")&&404==e.data.status.status_code)break;e.data.hasOwnProperty(t)&&(r[t]=e.data[t][0])}}}),r},getRecent:function(a,t,r){var n=[],s="/search/recent",o="?callback=JSON_CALLBACK",c=s+"/"+t+"/"+a+o;return e.get(c).then(function(e){for(var a=e.data.games,t=0;t<a.length;t++)n[t]=a[t];r&&r()}),n}}}]);